{"paragraphs":[{"title":"KA3 (SQL QUERIES)","text":"%md","user":"anonymous","dateUpdated":"2020-06-17T20:52:58+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true,"tableHide":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591481313143_103826624","id":"20200607-010833_1656158031","dateCreated":"2020-06-07T01:08:33+0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11076"},{"title":"Load athletes dataset","text":"val athleteText = sc.textFile(\"C:/Users/Administrator/Downloads/athletes.csv\")\r\n\r\ncase class Athlete(ID : String, Name : String, Sex : String, Age : String, Height : String, Weight : String, Team : String, NOC : String, Games: String, Year : String, Season : String, City : String, Sport : String, Event: String, Medal : String)\r\n\r\n\r\n// split each line, filter out header (starts with \"ID\"), and map it into Athlete case class  \r\nval athlete = athleteText.map(s=>s.split(\";\")).filter(s=>s(0)!=\"ID\").map(\r\n    s=>Athlete(s(0).replaceAll(\"\\\"\", \"\"), \r\n    s(1).replaceAll(\"\\\"\", \"\"),\r\n    s(2).replaceAll(\"\\\"\", \"\"),\r\n    s(3).replaceAll(\"\\\"\", \"\"),\r\n    s(4).replaceAll(\"\\\"\", \"\"),\r\n    s(5).replaceAll(\"\\\"\", \"\"),\r\n    s(6).replaceAll(\"\\\"\", \"\"),\r\n    s(7).replaceAll(\"\\\"\", \"\"),\r\n    s(8).replaceAll(\"\\\"\", \"\"),\r\n    s(9).replaceAll(\"\\\"\", \"\"),\r\n    s(10).replaceAll(\"\\\"\", \"\"),\r\n    s(11).replaceAll(\"\\\"\", \"\"),\r\n    s(12).replaceAll(\"\\\"\", \"\"),\r\n    s(13).replaceAll(\"\\\"\", \"\"),\r\n    s(14).replaceAll(\"\\\"\", \"\")\r\n        )\r\n)\r\n\r\n// convert to DataFrame and create temporal table\r\nathlete.toDF().registerTempTable(\"athletes\")","user":"anonymous","dateUpdated":"2020-06-17T20:52:58+0300","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nimport sqlContext.implicits._\r\nathleteText: org.apache.spark.rdd.RDD[String] = C:/Users/Administrator/Downloads/athletes.csv MapPartitionsRDD[726] at textFile at <console>:16\r\ndefined class Athlete\r\nathlete: org.apache.spark.rdd.RDD[Athlete] = MapPartitionsRDD[729] at map at <console>:22\n"}]},"apps":[],"jobName":"paragraph_1591481251030_1954960885","id":"20200604-003546_1779010128","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:53:29+0300","dateFinished":"2020-06-12T01:53:30+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11077"},{"title":"Load regions dataset","text":"val regionText = sc.textFile(\"C:/Users/Administrator/Downloads/regions.csv\")\r\n\r\ncase class Region(NOC : String, region : String, notes : String)\r\n\r\n\r\n// split each line, filter out header (starts with \"ID\"), and map it into Athlete case class  \r\nval region = regionText.map(s=>s.split(\";\")).filter(s=>s(0)!=\"ID\").map(\r\n    s=>Region(s(0).replaceAll(\"\\\"\", \"\"), \r\n    s(1).replaceAll(\"\\\"\", \"\"),\r\n    s(2).replaceAll(\"\\\"\", \"\")\r\n        )\r\n)\r\n// convert to DataFrame and create temporal table\r\nregion.toDF().registerTempTable(\"regions\")","user":"anonymous","dateUpdated":"2020-06-17T20:52:58+0300","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nimport sqlContext.implicits._\r\nregionText: org.apache.spark.rdd.RDD[String] = C:/Users/Administrator/Downloads/regions.csv MapPartitionsRDD[731] at textFile at <console>:16\r\ndefined class Region\r\nregion: org.apache.spark.rdd.RDD[Region] = MapPartitionsRDD[734] at map at <console>:22\n"}]},"apps":[],"jobName":"paragraph_1591481251030_960575329","id":"20200604-215312_2020824552","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:53:31+0300","dateFinished":"2020-06-12T01:53:32+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11078"},{"title":"Problem 1: Number of Medals 1896-2016","text":"%sql\r\n--Problem 1: Number of Medals 1896-2016\r\nselect Medal, count(Medal) as `Number of Medals`\r\nfrom athletes\r\nwhere  Medal <> 'NA'\r\ngroup by Medal","user":"anonymous","dateUpdated":"2020-06-17T20:52:58+0300","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"Medal","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Medals","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"updated":false,"names":{"Medal":"string","Number of Medals":"string"}},"updated":false,"initialized":false,"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false}},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate","stacked":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{}},"commonSetting":{},"keys":[{"name":"Medal","index":0,"aggr":"sum"}],"groups":[{"name":"Medal","index":0,"aggr":"sum"}],"values":[{"name":"Number of Medals","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Medal\tNumber of Medals\nSilver\t13116\nGold\t13372\nBronze\t13295\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251030_292546971","id":"20200604-120631_1091148274","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:53:32+0300","dateFinished":"2020-06-12T01:53:36+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11079"},{"title":"Problem 2: Number of sports in Olympics 1896-2016","text":"%sql\r\n--Problem 2: Number of sports in Olympics 1896-2016\r\nselect count(distinct Sport) as `Number of sports in Olympic history`\r\nfrom athletes","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":328,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Number of sports in Olympic history":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Number of sports in Olympic history","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Number of sports in Olympic history","index":0,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":246,"optionOpen":false}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Number of sports in Olympic history\n66\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251031_-227883675","id":"20200604-141717_1139769208","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:53:36+0300","dateFinished":"2020-06-12T01:53:40+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11080"},{"title":"Problem 3:Finding number of medal for a country","text":"%sql\n--Problem 3:Finding number of medal for a country\nselect NOC, count(Medal) as Medal\nfrom athletes\nwhere Medal <> 'NA' and Medal = 'Gold'\ngroup by NOC\norder by Medal desc\nlimit 10","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":338,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"NOC":"string","Medal":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{}},"commonSetting":{},"keys":[{"name":"NOC","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Medal","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"NOC\tMedal\nUSA\t2638\nURS\t1082\nGER\t745\nGBR\t678\nITA\t575\nFRA\t501\nSWE\t479\nCAN\t463\nHUN\t432\nGDR\t397\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251031_1443852800","id":"20200604-153457_240916914","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:53:41+0300","dateFinished":"2020-06-12T01:53:44+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11081"},{"title":"4.Female and Male players","text":"%sql\n--4.Female and Male players\nselect Sex, count(1) as `Players` from athletes where Sex = 'F' group by Sex\nunion all\nselect Sex, count(1) as `Players` from athletes where Sex = 'M' group by Sex\n","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"pieChart","height":366,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Sex":"string","Players":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{}},"commonSetting":{},"keys":[{"name":"Sex","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Players","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Sex\tPlayers\nF\t74522\nM\t196594\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251031_14250596","id":"20200604-004511_1323190333","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:53:44+0300","dateFinished":"2020-06-12T01:53:50+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11082"},{"title":"Problem 5: Football gold medals","text":"%sql\r\n--Problem 5: Football gold medals\r\nselect NOC, count(Medal) as `Football Gold Medals `\r\nfrom athletes\r\nwhere Medal <> 'NA' and Sport = 'Football' and Medal = 'Gold'\r\ngroup by NOC\r\norder by count(Medal) desc\r\n","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":456,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"NOC":"string","Football Gold Medals":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"NOC","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Football Gold Medals","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"NOC\tFootball Gold Medals\nUSA\t66\nHUN\t46\nGBR\t36\nURS\t36\nARG\t34\nURU\t31\nGER\t18\nCMR\t18\nPOL\t17\nNOR\t17\nBRA\t17\nGDR\t17\nESP\t17\nFRA\t16\nTCH\t16\nMEX\t16\nNGR\t16\nYUG\t16\nITA\t14\nBEL\t14\nCAN\t13\nDEN\t12\nSWE\t12\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251031_1723882239","id":"20200604-005454_2137495100","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:53:50+0300","dateFinished":"2020-06-12T01:53:53+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11083"},{"title":"Problem 6: Median height/weight of an Olympic medalist","text":"%sql\n--Problem 6: Median height/weight of an Olympic medalist\n--Average Height\nselect round(AVG(Height),2) as `Average Height`\nfrom athletes\nwhere Height<> 'NA' and Medal <> 'NA' or Medal <> null\n","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":92,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Average Height":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Average Height\n177.55\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251032_-1679890039","id":"20200604-154852_2100869939","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:53:53+0300","dateFinished":"2020-06-12T01:53:55+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11084"},{"text":"%sql\n--Problem 6: Median height/weight of an Olympic medalist\n--Average Weight\nselect round(AVG(Weight),2) as `Average Weight`\nfrom athletes\nwhere Weight<> 'NA' and  Medal<> 'NA'","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":160,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Average Weight":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Average Weight\n73.77\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251032_1142170309","id":"20200604-160132_26755893","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:53:56+0300","dateFinished":"2020-06-12T01:53:58+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11085"},{"title":"Problem 7: Top countries with most medal won by female athletes","text":"%sql\n--Problem 7: Top countries with most medal won by female athletes\nselect NOC Country,count(Medal) as `Medal Won by Female Athletes`\nfrom athletes\nwhere Sex =  'F' and Medal <> 'NA'\ngroup by Noc\norder by count(Medal) desc\nlimit 10","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"stackedAreaChart","height":536,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Country":"string","Medal Won by Female Athletes":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Country","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Medal Won by Female Athletes","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Country\tMedal Won by Female Athletes\nUSA\t1805\nURS\t687\nGER\t675\nCHN\t654\nRUS\t553\nAUS\t547\nCAN\t520\nGDR\t437\nNED\t432\nGBR\t395\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251033_2099491550","id":"20200604-165057_844113734","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:53:58+0300","dateFinished":"2020-06-12T01:54:01+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11086"},{"title":"Problem 8: 1896-2016 countries and medals in each olympics year","text":"%sql\n--Problem 8: 1896-2016 countries and medals in each olympics year\nselect y.Country, y.Year, y.Medals\nfrom\n(select Year as year, max(a.Medals) as mm\nfrom(\nselect  Noc Country,Year,count(Medal) as Medals\nfrom athletes\nwhere Medal <> 'NA' \ngroup by Noc,Year)\nas a\ngroup by year\n--order by year,mm desc\n) as x\ninner join (select  Noc Country,Year,count(Medal) as Medals\nfrom athletes\nwhere Medal <> 'NA'\ngroup by Year,NOC) as y on y.Year = x.year and y.Medals = x.mm\norder by y.Year,y.Medals desc\n\n","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"lineChart","height":358,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Country":"string","Year":"string","Medals":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Country","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Year","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Country\tYear\tMedals\nGRE\t1896\t48\nFRA\t1900\t235\nUSA\t1904\t394\nGRE\t1906\t102\nGBR\t1908\t368\nSWE\t1912\t190\nUSA\t1920\t194\nUSA\t1924\t194\nUSA\t1928\t102\nUSA\t1932\t223\nGER\t1936\t231\nUSA\t1948\t168\nUSA\t1952\t164\nURS\t1956\t206\nURS\t1960\t211\nURS\t1964\t221\nURS\t1968\t229\nURS\t1972\t259\nURS\t1976\t342\nURS\t1980\t496\nUSA\t1984\t361\nURS\t1988\t366\nEUN\t1992\t279\nGER\t1994\t40\nUSA\t1996\t259\nFIN\t1998\t58\nUSA\t2000\t242\nUSA\t2002\t84\nUSA\t2004\t263\nCAN\t2006\t69\nUSA\t2008\t317\nUSA\t2010\t97\nUSA\t2012\t248\nCAN\t2014\t86\nUSA\t2016\t264\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251033_-1962911629","id":"20200604-165358_1201320281","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:54:01+0300","dateFinished":"2020-06-12T01:54:18+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11087"},{"title":"Problem 9: (a) Gender Distribution for Summer Olympics","text":"%sql\n--Problem 9:(a) Gender Distribution for Summer Olympics\nselect 'Men' as gender,count(Sex) as `summer participants`, \n(round(((Count(Sex)* 100) / (Select count(Sex) From athletes where Season = 'Summer')),2))  as percentage\nfrom athletes\nwhere Sex = 'M' and Season = 'Summer'\n\nunion all\n\nselect 'Women' as gender, count(Sex) as `summer participants`, \n(round(((Count(Sex)* 100) / (Select count(Sex) From athletes where Season = 'Summer')),2))  as percentage\nfrom athletes\nwhere Sex = 'F' and Season = 'Summer'\n","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":242,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"gender":"string","summer participants":"string","percentage":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{}},"commonSetting":{},"keys":[{"name":"gender","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"percentage","index":2,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"gender\tsummer participants\tpercentage\nMen\t163109\t73.29\nWomen\t59443\t26.71\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251033_2033602847","id":"20200604-174053_223559557","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:54:18+0300","dateFinished":"2020-06-12T01:54:27+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11088"},{"title":"Problem 9: (b) Gender Distribution for Summer and Winter Olympic","text":"%sql\n--Problem 9:(b) Gender Distribution for Winter Olympics\nselect 'Men' as gender,count(Sex) as `winter participants`, \n(round(((Count(Sex)* 100) / (Select count(Sex) From athletes where Season = 'Winter')),2))  as percentage\nfrom athletes\nwhere Sex = 'M' and Season = 'Winter'\n\nunion all\n\nselect 'Women' as gender, count(Sex) as `winter participants`, \n(round(((Count(Sex)* 100) / (Select count(Sex) From athletes where Season = 'Winter')),2))  as percentage\nfrom athletes\nwhere Sex = 'F' and Season = 'Winter'","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":260,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"gender":"string","winter participants":"string","percentage":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"gender","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"winter participants","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"gender\twinter participants\tpercentage\nMen\t33485\t68.95\nWomen\t15079\t31.05\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251033_2095729534","id":"20200604-190817_2023330969","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:54:27+0300","dateFinished":"2020-06-12T01:54:36+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11089"},{"title":"Problem 10: Countries participation at Summer Olympic Games over the years","text":"%sql\n--Problem 10: Countries participation at Summer Olympic Games over the years\nselect Year, count(a.cc) `Countries Participated`\nfrom\n(\nselect  Year, count(distinct NOC) as cc\nfrom athletes \nwhere Season = 'Summer'\nGroup by Year,NOC) a\nGroup by Year\norder by Year","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":384,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Year":"string","Countries Participated":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{}},"commonSetting":{},"keys":[{"name":"Year","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Countries Participated","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Year\tCountries Participated\n1896\t12\n1900\t31\n1904\t15\n1906\t21\n1908\t22\n1912\t29\n1920\t29\n1924\t45\n1928\t46\n1932\t47\n1936\t49\n1948\t59\n1952\t69\n1956\t72\n1960\t84\n1964\t93\n1968\t112\n1972\t121\n1976\t92\n1980\t80\n1984\t140\n1988\t159\n1992\t169\n1996\t197\n2000\t200\n2004\t201\n2008\t204\n2012\t205\n2016\t207\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251033_-1890888498","id":"20200604-200828_2024532226","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:54:36+0300","dateFinished":"2020-06-12T01:54:45+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11090"},{"title":"Problem 11: Nations with highest number of participation in summer Olympics","text":"%sql\n--Problem 11: Nations with highest number of participation in summer Olympics\nselect a.region as Country, count(a.cc) as `Times Participated`\nfrom\n(select region, count(distinct ath.NOC) as cc\nfrom athletes ath\ninner join regions reg on ath.NOC = reg.NOC\nwhere Season = 'Summer'\ngroup by reg.region, Year) a\ngroup by region\norder by count(a.cc) desc\nlimit 50\n","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":356,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Country":"string","Times Participated":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Country","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Times Participated","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Country\tTimes Participated\nFrance\t29\nGreece\t29\nAustralia\t29\nUK\t29\nItaly\t29\nSwitzerland\t29\nDenmark\t28\nUSA\t28\nAustria\t28\nSweden\t28\nHungary\t27\nCanada\t27\nBelgium\t27\nNorway\t27\nNetherlands\t27\nFinland\t26\nCzech Republic\t26\nGermany\t26\nLuxembourg\t25\nIndia\t24\nPortugal\t24\nNew Zealand\t24\nArgentina\t24\nBrazil\t23\nMexico\t23\nSerbia\t23\nTurkey\t23\nSpain\t23\nPoland\t22\nJapan\t22\nRomania\t22\nChile\t22\nPhilippines\t21\nEgypt\t21\nIreland\t21\nIceland\t21\nMonaco\t21\nCuba\t21\nUruguay\t21\nColombia\t20\nPeru\t20\nBulgaria\t20\nRussia\t20\nChina\t19\nSouth Africa\t19\nVenezuela\t19\nTrinidad\t18\nBermuda\t18\nPuerto Rico\t18\nMyanmar\t17\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251034_-457118349","id":"20200604-201153_46203259","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:54:45+0300","dateFinished":"2020-06-12T01:54:59+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11091"},{"title":"Problem 12: (a)Host cities for summer olympics","text":"%sql\nselect  a.City, count(a.cc) `Hosted times`\nfrom\n(\nselect City, count(distinct City) as cc\nfrom  athletes\nwhere Season = 'Summer'\ngroup by City,Year) a\ngroup by City\norder by count(a.cc) desc\n","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"City":"string","Hosted times":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"City","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Hosted times","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"City\tHosted times\nAthina\t3\nLondon\t3\nLos Angeles\t2\nStockholm\t2\nParis\t2\nBeijing\t1\nBerlin\t1\nSt. Louis\t1\nMontreal\t1\nMexico City\t1\nRoma\t1\nSydney\t1\nAtlanta\t1\nTokyo\t1\nMelbourne\t1\nSeoul\t1\nBarcelona\t1\nAmsterdam\t1\nMoskva\t1\nHelsinki\t1\nAntwerpen\t1\nRio de Janeiro\t1\nMunich\t1\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251034_-673512270","id":"20200604-221605_1030542928","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:54:59+0300","dateFinished":"2020-06-12T01:55:03+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11092"},{"title":"Problem 12: (b)Host cities for and winter olympic","text":"%sql\nselect  a.City, count(a.cc) `Hosted times`\nfrom\n(\nselect City, COUNT(distinct City) as cc\nfrom  athletes\nwhere Season = 'Winter'\ngroup by City,Year) a\ngroup by City\norder by count(a.cc) desc\n","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"City":"string","Hosted times":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"City","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Hosted times","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"City\tHosted times\nLake Placid\t2\nSankt Moritz\t2\nInnsbruck\t2\nGrenoble\t1\nSquaw Valley\t1\nSarajevo\t1\nOslo\t1\nSochi\t1\nChamonix\t1\nAlbertville\t1\nLillehammer\t1\nNagano\t1\nVancouver\t1\nCortina d'Ampezzo\t1\nCalgary\t1\nSapporo\t1\nGarmisch-Partenkirchen\t1\nTorino\t1\nSalt Lake City\t1\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251034_-1616127980","id":"20200604-225148_905965738","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:55:03+0300","dateFinished":"2020-06-12T01:55:07+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11093"},{"title":"Problem 13: Average age by sport category","text":"%sql\nselect Distinct a.Sport, round(avg(a.avg_age),2) as `Average Age`\nfrom\n(\nselect Distinct Sport, ID, avg(Age) as avg_age\nfrom athletes\nwhere Age <> 'NA' \ngroup by Sport,ID,Event\n) a\ngroup by Sport\norder by `Average Age`\n","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":304,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Sport":"string","Average Age":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Sport","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Average Age","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Sport\tAverage Age\nRhythmic Gymnastics\t18.54\nSwimming\t20.5\nFigure Skating\t21.81\nDiving\t22.23\nSynchronized Swimming\t22.27\nGymnastics\t22.41\nShort Track Speed Skating\t22.71\nBoxing\t22.91\nAlpine Skiing\t23.11\nSki Jumping\t23.32\nFootball\t23.51\nMilitary Ski Patrol\t23.74\nTaekwondo\t23.93\nSpeed Skating\t24.06\nLuge\t24.1\nNordic Combined\t24.27\nFreestyle Skiing\t24.31\nRugby\t24.41\nCycling\t24.52\nSnowboarding\t24.59\nTrampolining\t24.65\nVolleyball\t24.92\nRowing\t24.97\nAthletics\t25.01\nBasketball\t25.04\nJudo\t25.09\nCanoeing\t25.23\nWeightlifting\t25.25\nWater Polo\t25.29\nBadminton\t25.42\nIce Hockey\t25.5\nHockey\t25.52\nWrestling\t25.6\nTennis\t25.66\nBaseball\t25.94\nCross Country Skiing\t25.97\nHandball\t25.98\nAeronautics\t26.0\nBasque Pelota\t26.0\nRugby Sevens\t26.05\nTable Tennis\t26.07\nSoftball\t26.12\nBiathlon\t26.31\nModern Pentathlon\t26.34\nLacrosse\t26.86\nRacquets\t27.57\nTriathlon\t27.71\nArchery\t28.08\nFencing\t28.3\nBobsleigh\t28.83\nTug-Of-War\t28.91\nBeach Volleyball\t29.02\nCricket\t29.33\nGolf\t29.88\nSkeleton\t29.94\nSailing\t29.98\nCurling\t31.48\nJeu De Paume\t32.45\nCroquet\t32.88\nShooting\t33.12\nEquestrianism\t33.89\nMotorboating\t34.33\nPolo\t35.39\nAlpinism\t38.81\nArt Competitions\t44.59\nRoque\t53.33\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251034_1939328547","id":"20200604-225519_1398582677","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:55:08+0300","dateFinished":"2020-06-12T01:56:05+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11094"},{"title":"Problem 14: Top 10 athlethes with most medals in summer Olympics","text":"%sql\nselect Name, count(Medal) as `Total Medals`\nfrom athletes\nwhere Medal <> 'NA'\nand Season = 'Summer'\ngroup by Name\norder by `Total Medals` desc\nlimit 10\n","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"lineNumbers":true,"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":324,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Name":"string","Total Medals":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Name","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Total Medals","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Name\tTotal Medals\nMichael Fred Phelps, II\t28\nLarysa Semenivna Latynina (Diriy-)\t18\nNikolay Yefimovich Andrianov\t15\nBorys Anfiyanovych Shakhlin\t13\nTakashi Ono\t13\nEdoardo Mangiarotti\t13\nNatalie Anne Coughlin (-Hall)\t12\nRyan Steven Lochte\t12\nDara Grace Torres (-Hoffman, -Minas)\t12\nJennifer Elisabeth Jenny Thompson (-Cumpelik)\t12\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251034_-1332751966","id":"20200604-225750_2022784127","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:56:05+0300","dateFinished":"2020-06-12T01:56:09+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11095"},{"title":"Problem 15: Turkey in Summer Olympics","text":"%sql\nselect  region as Country,Year, count(a.cc) as `Athletes Participated`\nfrom\n(\nselect Distinct ID, region, Year ,COUNT( distinct ath.ID) cc\nfrom athletes ath\ninner join regions reg on ath.NOC = reg.NOC\nwhere ath.NOC = 'TUR' and Season = 'Summer'\ngroup by region, ID,Year) a\ngroup by region, Year\n","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"lineChart","height":424,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Country":"string","Year":"string","Athletes Participated":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Year","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"Athletes Participated","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Country\tYear\tAthletes Participated\nTurkey\t2004\t64\nTurkey\t1912\t2\nTurkey\t1964\t23\nTurkey\t1932\t1\nTurkey\t1968\t29\nTurkey\t1906\t1\nTurkey\t2012\t112\nTurkey\t1972\t43\nTurkey\t1984\t46\nTurkey\t1960\t49\nTurkey\t1936\t48\nTurkey\t2016\t100\nTurkey\t1992\t41\nTurkey\t1924\t22\nTurkey\t1996\t53\nTurkey\t1976\t27\nTurkey\t1988\t41\nTurkey\t1948\t58\nTurkey\t1956\t19\nTurkey\t1952\t51\nTurkey\t2000\t57\nTurkey\t2008\t67\nTurkey\t1928\t31\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1591481251035_-1378553305","id":"20200604-230926_1645745699","dateCreated":"2020-06-07T01:07:31+0300","dateStarted":"2020-06-12T01:56:09+0300","dateFinished":"2020-06-12T01:56:18+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11096"},{"title":"KA5 (ML) : Kısım 1 (Regresyon Analizi): Daha once kullanmıs oldugunuz (kesif aktivitesi 1 spreadsheet) veriseti üzerindeki kolonlar (Nümerik predictors ve nümerik cikti) arasındaki pozitif ve negatif korelasyonu bulunuz. r veya R^2 değerlerini belirleyiniz","text":"%md\n","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true,"title":true,"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591481251035_-1008126911","id":"20200604-231321_1180195841","dateCreated":"2020-06-07T01:07:31+0300","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11097"},{"title":"Load dataset","text":"%pyspark\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.stat import Correlation\nimport numpy as np\nimport pandas as pd\n\ntop100_athletes = pd.read_csv(\"top100_athletes.csv\", sep=';')\ntop100_athletes.head(5)","user":"anonymous","dateUpdated":"2020-06-17T20:52:59+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"                                 Name  Gold  Silver  Bronze  Total\n0             Michael Fred Phelps, II  23.0     3.0     2.0     28\n1  Larysa Semenivna Latynina (Diriy-)   9.0     5.0     4.0     18\n2        Nikolay Yefimovich Andrianov   7.0     5.0     3.0     15\n3                 Edoardo Mangiarotti   6.0     5.0     2.0     13\n4         Borys Anfiyanovych Shakhlin   7.0     4.0     2.0     13"}]},"apps":[],"jobName":"paragraph_1591907108540_-893896633","id":"20200611-232508_988030978","dateCreated":"2020-06-11T23:25:08+0300","dateStarted":"2020-06-12T02:01:32+0300","dateFinished":"2020-06-12T02:01:32+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11098"},{"title":"Convert pandas dataframe to RDD","text":"%pyspark\ntop100_spDF = sqlContext.createDataFrame(top100_athletes)\ntop100_spDF.show(5)","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----+------+------+-----+\n|                Name|Gold|Silver|Bronze|Total|\n+--------------------+----+------+------+-----+\n|Michael Fred Phel...|23.0|   3.0|   2.0|   28|\n|Larysa Semenivna ...| 9.0|   5.0|   4.0|   18|\n|Nikolay Yefimovic...| 7.0|   5.0|   3.0|   15|\n| Edoardo Mangiarotti| 6.0|   5.0|   2.0|   13|\n|Borys Anfiyanovyc...| 7.0|   4.0|   2.0|   13|\n+--------------------+----+------+------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1591907533339_-1770190777","id":"20200611-233213_127196017","dateCreated":"2020-06-11T23:32:13+0300","dateStarted":"2020-06-12T01:57:44+0300","dateFinished":"2020-06-12T01:57:45+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11099"},{"text":"%pyspark\ntop100_num = top100_spDF[[\"Gold\",\"Silver\",\"Bronze\",\"Total\"]]\ntop100_num.show(5)","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+------+------+-----+\n|Gold|Silver|Bronze|Total|\n+----+------+------+-----+\n|23.0|   3.0|   2.0|   28|\n| 9.0|   5.0|   4.0|   18|\n| 7.0|   5.0|   3.0|   15|\n| 6.0|   5.0|   2.0|   13|\n| 7.0|   4.0|   2.0|   13|\n+----+------+------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1591911201395_-1046699210","id":"20200612-003321_779481971","dateCreated":"2020-06-12T00:33:21+0300","dateStarted":"2020-06-12T01:57:49+0300","dateFinished":"2020-06-12T01:57:49+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11100"},{"text":"%pyspark\n#Dataframe to vector for correlation\nfrom pyspark.ml.feature import VectorAssembler\nnewdb = VectorAssembler(inputCols=[\"Gold\", \"Silver\", \"Bronze\",'Total'], outputCol=\"features\").transform(top100_num)\n\nnumeric_df = newdb.select(\"features\")\nnumeric_df.show(5)\n\n\n\n","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+\n|           features|\n+-------------------+\n|[23.0,3.0,2.0,28.0]|\n| [9.0,5.0,4.0,18.0]|\n| [7.0,5.0,3.0,15.0]|\n| [6.0,5.0,2.0,13.0]|\n| [7.0,4.0,2.0,13.0]|\n+-------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1591907332775_-273478929","id":"20200611-232852_1453853454","dateCreated":"2020-06-11T23:28:52+0300","dateStarted":"2020-06-12T01:57:52+0300","dateFinished":"2020-06-12T01:57:53+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11101"},{"title":"Pearson Correlation Matrix","text":"%pyspark\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.stat import Correlation\nimport numpy as np\n\nr1 = Correlation.corr(numeric_df, \"features\").head()\nprint(\"Pearson correlation matrix:\\n\" + str(r1[0]))\n","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Pearson correlation matrix:\nDenseMatrix([[ 1.        , -0.26055523, -0.26435052,  0.75048192],\n             [-0.26055523,  1.        , -0.1333802 ,  0.20542508],\n             [-0.26435052, -0.1333802 ,  1.        ,  0.19857129],\n             [ 0.75048192,  0.20542508,  0.19857129,  1.        ]])\n"}]},"apps":[],"jobName":"paragraph_1591911583516_-94681931","id":"20200612-003943_1203315263","dateCreated":"2020-06-12T00:39:43+0300","dateStarted":"2020-06-12T01:57:59+0300","dateFinished":"2020-06-12T01:58:01+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11102"},{"title":"Spearman Correlation Matrix","text":"%pyspark\nr2 = Correlation.corr(numeric_df, \"features\", \"spearman\").head()\nprint(\"Spearman correlation matrix:\\n\" + str(r2[0]))","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Spearman correlation matrix:\nDenseMatrix([[ 1.        , -0.35503045, -0.30352268,  0.51668991],\n             [-0.35503045,  1.        , -0.16412861,  0.24557694],\n             [-0.30352268, -0.16412861,  1.        ,  0.18467777],\n             [ 0.51668991,  0.24557694,  0.18467777,  1.        ]])\n"}]},"apps":[],"jobName":"paragraph_1591912846148_-1879049486","id":"20200612-010046_1950401278","dateCreated":"2020-06-12T01:00:46+0300","dateStarted":"2020-06-12T01:58:04+0300","dateFinished":"2020-06-12T01:58:06+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11103"},{"text":"%pyspark\n# Gold - Total (R Squared) daha sonra\n\ndf_feat = VectorAssembler(inputCols=[\"Gold\"], outputCol=\"features\").transform(top100_num)\ndf_feat2 = df_feat.select(\"features\")\ndf_feat2.show(5)","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|features|\n+--------+\n|  [23.0]|\n|   [9.0]|\n|   [7.0]|\n|   [6.0]|\n|   [7.0]|\n+--------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1591914657085_-779598772","id":"20200612-013057_26579725","dateCreated":"2020-06-12T01:30:57+0300","dateStarted":"2020-06-12T01:58:18+0300","dateFinished":"2020-06-12T01:58:19+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11104"},{"text":"%pyspark\n#Gold - Total (R Squared\nfrom pyspark.ml.feature import VectorAssembler\n\nvectorAssembler = VectorAssembler(inputCols = ['Gold', 'Silver', 'Bronze'], outputCol = 'output')\nnewdb2 = vectorAssembler.transform(df_feat)\nnewdb3 = newdb2.select(['features', 'Total'])\nnewdb3.show(3)","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----+\n|features|Total|\n+--------+-----+\n|  [23.0]|   28|\n|   [9.0]|   18|\n|   [7.0]|   15|\n+--------+-----+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1591913446783_-1495694486","id":"20200612-011046_851282295","dateCreated":"2020-06-12T01:10:46+0300","dateStarted":"2020-06-12T01:58:54+0300","dateFinished":"2020-06-12T01:58:55+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11105"},{"text":"%pyspark\nsplits = newdb3.randomSplit([0.8, 0.2])\ntrain_df = splits[0]\ntest_df = splits[1]","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1591914024798_1294366291","id":"20200612-012024_2113413286","dateCreated":"2020-06-12T01:20:24+0300","dateStarted":"2020-06-12T01:58:58+0300","dateFinished":"2020-06-12T01:58:58+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11106"},{"title":"Linear Regression","text":"%pyspark\nfrom pyspark.ml.regression import LinearRegression\nlr = LinearRegression(featuresCol = 'features', labelCol='Total', maxIter=10, regParam=0.3, elasticNetParam=0.8)\nlr_model = lr.fit(train_df)\nprint(\"Coefficients: \" + str(lr_model.coefficients))\nprint(\"Intercept: \" + str(lr_model.intercept))","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Coefficients: [0.6405220976916727]\nIntercept: 6.374551811740464\n"}]},"apps":[],"jobName":"paragraph_1591914081254_-1548973699","id":"20200612-012121_1777638882","dateCreated":"2020-06-12T01:21:21+0300","dateStarted":"2020-06-12T01:59:00+0300","dateFinished":"2020-06-12T01:59:02+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11107"},{"title":"R squared of Gold medals and Total medals","text":"%pyspark\ntrainingSummary = lr_model.summary\nprint(\"RMSE: %f\" % trainingSummary.rootMeanSquaredError)\nprint(\"r2: %f\" % trainingSummary.r2)","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"RMSE: 1.862437\nr2: 0.567717\n"}]},"apps":[],"jobName":"paragraph_1591913242374_-1302456734","id":"20200612-010722_1419433564","dateCreated":"2020-06-12T01:07:22+0300","dateStarted":"2020-06-12T01:59:05+0300","dateFinished":"2020-06-12T01:59:05+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11108"},{"title":"KA5 (ML) : Kısım 2 (Ekteki verisetlerinden biri üzerinde herhangi bir sınıflandırma algoritması gerçekleme) Sectiginiz verisetini Google Drive'da belirtiniz. Her kişi farklı veriseti seçmelidir. Veriseti üzerinde gerekiyorsa birtakım önişlemler yapılmalı, bir sınıflandırma modeli olusturularak modelin performansı çeşitli metriklerle sunulmalıdır","text":"%md\n","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","title":true,"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591481765251_257389202","id":"20200607-011605_1620664557","dateCreated":"2020-06-07T01:16:05+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11109"},{"title":"Load dataset","text":"%pyspark\nimport pandas as pd\nfrom pyspark.mllib.classification import NaiveBayes, NaiveBayesModel\nfrom pyspark.mllib.util import MLUtils\n\ndr_test = pd.read_csv(\"drugLibTest_raw.tsv\",sep='\\t')\ndr_train = pd.read_csv(\"drugLibTrain_raw.tsv\",sep='\\t')\n\ndrug_data =  pd.concat([dr_train, dr_test])\n\n","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1591490864763_137246400","id":"20200607-034744_1012225601","dateCreated":"2020-06-07T03:47:44+0300","dateStarted":"2020-06-16T19:48:48+0300","dateFinished":"2020-06-16T19:48:48+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11110"},{"text":"%pyspark\ndrug_data = drug_data.dropna()","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","tableHide":false,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592249929719_-1793197859","id":"20200615-223849_1839672123","dateCreated":"2020-06-15T22:38:49+0300","dateStarted":"2020-06-16T19:49:12+0300","dateFinished":"2020-06-16T19:49:12+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11111"},{"title":"Convert pandas dataframe to RDD","text":"%pyspark\ndrug_data_spDF = sqlContext.createDataFrame(drug_data)\n","user":"anonymous","dateUpdated":"2020-06-17T20:53:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592249576275_-235604456","id":"20200615-223256_578668400","dateCreated":"2020-06-15T22:32:56+0300","dateStarted":"2020-06-16T20:00:15+0300","dateFinished":"2020-06-16T20:00:16+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11112"},{"text":"%pyspark\ndrug_train_spDF.show(5)\n","user":"anonymous","dateUpdated":"2020-06-17T20:53:01+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+----------------+------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+\n|Unnamed: 0|     urlDrugName|rating|       effectiveness|        sideEffects|           condition|      benefitsReview|   sideEffectsReview|      commentsReview|\n+----------+----------------+------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+\n|      2202|       enalapril|     4|    Highly Effective|  Mild Side Effects|management of con...|slowed the progre...|cough, hypotensio...|monitor blood pre...|\n|      3117|ortho-tri-cyclen|     1|    Highly Effective|Severe Side Effects|    birth prevention|Although this typ...|Heavy Cycle, Cram...|I Hate This Birth...|\n|      1146|         ponstel|    10|    Highly Effective|    No Side Effects|    menstrual cramps|I was used to hav...|Heavier bleeding ...|I took 2 pills at...|\n|      3947|        prilosec|     3|Marginally Effective|  Mild Side Effects|         acid reflux|The acid reflux w...|Constipation, dry...|I was given Prilo...|\n|      1951|          lyrica|     2|Marginally Effective|Severe Side Effects|        fibromyalgia|I think that the ...|I felt extremely ...|           See above|\n+----------+----------------+------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1591490873714_135891247","id":"20200607-034753_1502363221","dateCreated":"2020-06-07T03:47:53+0300","dateStarted":"2020-06-16T20:00:19+0300","dateFinished":"2020-06-16T20:00:19+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11113"},{"title":"dataframe info","text":"%pyspark\ndrug_data_spDF.toPandas().info()","user":"anonymous","dateUpdated":"2020-06-17T20:53:01+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 4132 entries, 0 to 4131\nData columns (total 9 columns):\n #   Column             Non-Null Count  Dtype \n---  ------             --------------  ----- \n 0   Unnamed: 0         4132 non-null   int64 \n 1   urlDrugName        4132 non-null   object\n 2   rating             4132 non-null   int64 \n 3   effectiveness      4132 non-null   object\n 4   sideEffects        4132 non-null   object\n 5   condition          4132 non-null   object\n 6   benefitsReview     4132 non-null   object\n 7   sideEffectsReview  4132 non-null   object\n 8   commentsReview     4132 non-null   object\ndtypes: int64(2), object(7)\nmemory usage: 290.7+ KB\n"}]},"apps":[],"jobName":"paragraph_1591490891251_700427706","id":"20200607-034811_168593812","dateCreated":"2020-06-07T03:48:11+0300","dateStarted":"2020-06-16T20:00:26+0300","dateFinished":"2020-06-16T20:00:28+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11114"},{"title":"Drop Unnamed column for the test and train dataframes","text":"%pyspark\ndata_spDF = drug_data_spDF.drop('Unnamed: 0')\ndata_spDF.show(5)","user":"anonymous","dateUpdated":"2020-06-17T20:53:01+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+\n|     urlDrugName|rating|       effectiveness|        sideEffects|           condition|      benefitsReview|   sideEffectsReview|      commentsReview|\n+----------------+------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+\n|       enalapril|     4|    Highly Effective|  Mild Side Effects|management of con...|slowed the progre...|cough, hypotensio...|monitor blood pre...|\n|ortho-tri-cyclen|     1|    Highly Effective|Severe Side Effects|    birth prevention|Although this typ...|Heavy Cycle, Cram...|I Hate This Birth...|\n|         ponstel|    10|    Highly Effective|    No Side Effects|    menstrual cramps|I was used to hav...|Heavier bleeding ...|I took 2 pills at...|\n|        prilosec|     3|Marginally Effective|  Mild Side Effects|         acid reflux|The acid reflux w...|Constipation, dry...|I was given Prilo...|\n|          lyrica|     2|Marginally Effective|Severe Side Effects|        fibromyalgia|I think that the ...|I felt extremely ...|           See above|\n+----------------+------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1591490903093_-1242720149","id":"20200607-034823_137656672","dateCreated":"2020-06-07T03:48:23+0300","dateStarted":"2020-06-16T20:00:40+0300","dateFinished":"2020-06-16T20:00:41+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11115"},{"text":"%pyspark\ndata_spDF.show(10)","user":"anonymous","dateUpdated":"2020-06-17T20:53:01+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|     urlDrugName|rating|       effectiveness|         sideEffects|           condition|      benefitsReview|   sideEffectsReview|      commentsReview|\n+----------------+------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|       enalapril|     4|    Highly Effective|   Mild Side Effects|management of con...|slowed the progre...|cough, hypotensio...|monitor blood pre...|\n|ortho-tri-cyclen|     1|    Highly Effective| Severe Side Effects|    birth prevention|Although this typ...|Heavy Cycle, Cram...|I Hate This Birth...|\n|         ponstel|    10|    Highly Effective|     No Side Effects|    menstrual cramps|I was used to hav...|Heavier bleeding ...|I took 2 pills at...|\n|        prilosec|     3|Marginally Effective|   Mild Side Effects|         acid reflux|The acid reflux w...|Constipation, dry...|I was given Prilo...|\n|          lyrica|     2|Marginally Effective| Severe Side Effects|        fibromyalgia|I think that the ...|I felt extremely ...|           See above|\n|        propecia|     1|         Ineffective| Severe Side Effects|           hair loss|after taking prop...|Low sex drive, be...| one pill once daily|\n|         vyvanse|     9|    Highly Effective|   Mild Side Effects|                 add|My mood has notic...|a few experiences...|I had began takin...|\n|          elavil|    10|Considerably Effe...|     No Side Effects|          depression|Although this dru...|               None.|One a day, taken ...|\n|           xanax|    10|    Highly Effective|     No Side Effects|      panic disorder|This simply just ...|I really don't ha...|I first started t...|\n|        claritin|     1|         Ineffective|Extremely Severe ...|           allergies|none - did nothin...|I had some horrif...|took one 10 mg pi...|\n+----------------+------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1592306220552_759724301","id":"20200616-141700_176236590","dateCreated":"2020-06-16T14:17:00+0300","dateStarted":"2020-06-16T20:00:52+0300","dateFinished":"2020-06-16T20:00:52+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11116"},{"text":"%pyspark\ndata_spDF.printSchema()","user":"anonymous","dateUpdated":"2020-06-17T20:53:01+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- urlDrugName: string (nullable = true)\n |-- rating: long (nullable = true)\n |-- effectiveness: string (nullable = true)\n |-- sideEffects: string (nullable = true)\n |-- condition: string (nullable = true)\n |-- benefitsReview: string (nullable = true)\n |-- sideEffectsReview: string (nullable = true)\n |-- commentsReview: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1592311722281_-1473399554","id":"20200616-154842_889481835","dateCreated":"2020-06-16T15:48:42+0300","dateStarted":"2020-06-16T20:00:57+0300","dateFinished":"2020-06-16T20:00:57+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11117"},{"text":"%pyspark\ndata_DF = data_spDF.drop('urlDrugName')\ndata_DF.show(5)","user":"anonymous","dateUpdated":"2020-06-17T20:53:01+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+\n|rating|       effectiveness|        sideEffects|           condition|      benefitsReview|   sideEffectsReview|      commentsReview|\n+------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+\n|     4|    Highly Effective|  Mild Side Effects|management of con...|slowed the progre...|cough, hypotensio...|monitor blood pre...|\n|     1|    Highly Effective|Severe Side Effects|    birth prevention|Although this typ...|Heavy Cycle, Cram...|I Hate This Birth...|\n|    10|    Highly Effective|    No Side Effects|    menstrual cramps|I was used to hav...|Heavier bleeding ...|I took 2 pills at...|\n|     3|Marginally Effective|  Mild Side Effects|         acid reflux|The acid reflux w...|Constipation, dry...|I was given Prilo...|\n|     2|Marginally Effective|Severe Side Effects|        fibromyalgia|I think that the ...|I felt extremely ...|           See above|\n+------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1592311957430_-1380394282","id":"20200616-155237_537174154","dateCreated":"2020-06-16T15:52:37+0300","dateStarted":"2020-06-16T20:01:12+0300","dateFinished":"2020-06-16T20:01:13+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11118"},{"text":"%pyspark\nfrom pyspark.ml.feature import RegexTokenizer, StopWordsRemover, CountVectorizer\nfrom pyspark.ml.classification import LogisticRegression\n# regular expression tokenizer\nregexTokenizer = RegexTokenizer(inputCol=\"sideEffectsReview\", outputCol=\"words\", pattern=\"\\\\W\")\n# stop words\nadd_stopwords = [\"ourselves\", \"hers\", \"between\", \"yourself\", \"but\", \"again\", \"there\", \"about\", \"once\", \"during\", \"out\", \"very\", \"having\", \"with\", \"they\", \"own\", \"an\", \"be\", \"some\", \"for\", \"do\", \"its\", \"yours\", \"such\", \"into\", \"of\", \"most\", \"itself\", \"other\", \"off\", \"is\", \"s\", \"am\", \"or\", \"who\", \"as\", \"from\", \"him\", \"each\", \"the\", \"themselves\", \"until\", \"below\", \"are\", \"we\", \"these\", \"your\", \"his\", \"through\", \"don\", \"nor\", \"me\", \"were\", \"her\", \"more\", \"himself\", \"this\", \"down\", \"should\", \"our\", \"their\", \"while\", \"above\", \"both\", \"up\", \"to\", \"ours\", \"had\", \"she\", \"all\", \"no\", \"when\", \"at\", \"any\", \"before\", \"them\", \"same\", \"and\", \"been\", \"have\", \"in\", \"will\", \"on\", \"does\", \"yourselves\", \"then\", \"that\", \"because\", \"what\", \"over\", \"why\", \"so\", \"can\", \"did\", \"not\", \"now\", \"under\", \"he\", \"you\", \"herself\", \"has\", \"just\", \"where\", \"too\", \"only\", \"myself\", \"which\", \"those\", \"i\", \"after\", \"few\", \"whom\", \"t\", \"being\", \"if\", \"theirs\", \"my\", \"against\", \"a\", \"by\", \"doing\", \"it\", \"how\", \"further\", \"was\", \"here\", \"than\"] \nstopwordsRemover = StopWordsRemover(inputCol=\"words\", outputCol=\"filtered\").setStopWords(add_stopwords)\n# bag of words count\ncountVectors = CountVectorizer(inputCol=\"filtered\", outputCol=\"features\", vocabSize=10000, minDF=5)","user":"anonymous","dateUpdated":"2020-06-17T20:53:01+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592320577713_-2146948421","id":"20200616-181617_1793997856","dateCreated":"2020-06-16T18:16:17+0300","dateStarted":"2020-06-16T20:52:21+0300","dateFinished":"2020-06-16T20:52:21+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11119"},{"text":"%pyspark\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.feature import OneHotEncoder, StringIndexer, VectorAssembler\n\nlabel_stringIdx = StringIndexer(inputCol = \"sideEffects\", outputCol = \"label\")\npipeline = Pipeline(stages=[regexTokenizer, stopwordsRemover, countVectors, label_stringIdx])\n# Fit the pipeline to training documents.\npipelineFit = pipeline.fit(data_DF)\ndataset = pipelineFit.transform(data_DF)\n\n#-------------------------------------------------------------------------------------------\n'''label_stringIdx = StringIndexer(inputCol = \"rating\", outputCol = \"label\")\npipeline = Pipeline(stages=[regexTokenizer, stopwordsRemover, countVectors, label_stringIdx])\n# Fit the pipeline to training documents.\npipelineFit = pipeline.fit(test_spDF)\ntest = pipelineFit.transform(test_spDF)'''\n\ndataset.show(5)","user":"anonymous","dateUpdated":"2020-06-17T20:53:01+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----+\n|rating|       effectiveness|        sideEffects|           condition|      benefitsReview|   sideEffectsReview|      commentsReview|               words|            filtered|            features|label|\n+------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----+\n|     4|    Highly Effective|  Mild Side Effects|management of con...|slowed the progre...|cough, hypotensio...|monitor blood pre...|[cough, hypotensi...|[cough, hypotensi...|(1889,[103,353,38...|  0.0|\n|     1|    Highly Effective|Severe Side Effects|    birth prevention|Although this typ...|Heavy Cycle, Cram...|I Hate This Birth...|[heavy, cycle, cr...|[heavy, cycle, cr...|(1889,[8,11,32,41...|  3.0|\n|    10|    Highly Effective|    No Side Effects|    menstrual cramps|I was used to hav...|Heavier bleeding ...|I took 2 pills at...|[heavier, bleedin...|[heavier, bleedin...|(1889,[139,266],[...|  1.0|\n|     3|Marginally Effective|  Mild Side Effects|         acid reflux|The acid reflux w...|Constipation, dry...|I was given Prilo...|[constipation, dr...|[constipation, dr...|(1889,[9,10,13,20...|  0.0|\n|     2|Marginally Effective|Severe Side Effects|        fibromyalgia|I think that the ...|I felt extremely ...|           See above|[i, felt, extreme...|[felt, extremely,...|(1889,[5,19,37,40...|  3.0|\n+------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1592320838153_357992430","id":"20200616-182038_1232517575","dateCreated":"2020-06-16T18:20:38+0300","dateStarted":"2020-06-16T20:52:25+0300","dateFinished":"2020-06-16T20:52:27+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11120"},{"text":"%pyspark\n# set seed for reproducibility\n(trainingData, testData) = dataset.randomSplit([0.85, 0.15], seed = 100)\nprint(\"Training Dataset Count: \" + str(trainingData.count()))\nprint(\"Test Dataset Count: \" + str(testData.count()))","user":"anonymous","dateUpdated":"2020-06-17T20:53:01+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Training Dataset Count: 3511\nTest Dataset Count: 621\n"}]},"apps":[],"jobName":"paragraph_1592323161623_-1626042968","id":"20200616-185921_620479814","dateCreated":"2020-06-16T18:59:21+0300","dateStarted":"2020-06-16T20:52:34+0300","dateFinished":"2020-06-16T20:52:36+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11121"},{"title":"Naive Bayes","text":"%pyspark\n\n# INPUT = sideEffectsReview\n# OUTPUT = sideEffects\n\nfrom pyspark.ml.classification import NaiveBayes\nnb = NaiveBayes(smoothing=1)\nmodel = nb.fit(trainingData)\npredictions = model.transform(testData)\npredictions.filter(predictions['prediction'] == 0).select(\"sideEffectsReview\",\"sideEffects\",\"probability\",\"label\",\"prediction\").orderBy(\"probability\", ascending=False).show(n = 10, truncate = 30)","user":"anonymous","dateUpdated":"2020-06-17T20:53:01+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------------------+-----------------------------+------------------------------+-----+----------+\n|             sideEffectsReview|                  sideEffects|                   probability|label|prediction|\n+------------------------------+-----------------------------+------------------------------+-----+----------+\n|none at 300 mg.  Possible t...|            Mild Side Effects|[0.9998630428094765,1.34774...|  0.0|       0.0|\n|The side effects for patien...|        Moderate Side Effects|[0.9998520960419472,2.01107...|  2.0|       0.0|\n|I experience regular mild f...|            Mild Side Effects|[0.9997659640122095,3.55640...|  0.0|       0.0|\n|Some drowsiness at night af...|Extremely Severe Side Effects|[0.999658237784179,8.131063...|  4.0|       0.0|\n|Side effects were minimal. ...|              No Side Effects|[0.9991888153104167,9.62627...|  1.0|       0.0|\n|The most noticeable side ef...|            Mild Side Effects|[0.9990289330721874,9.86215...|  0.0|       0.0|\n|I actually felt pretty upse...|            Mild Side Effects|[0.9986155534957459,1.07824...|  0.0|       0.0|\n|At 150mg/d side effects wer...|            Mild Side Effects|[0.996383848623397,0.002108...|  0.0|       0.0|\n|Severe grogginess, often ac...|        Moderate Side Effects|[0.9949595276584872,1.96046...|  2.0|       0.0|\n|The major side effect of dr...|        Moderate Side Effects|[0.9941689090005087,0.00308...|  2.0|       0.0|\n+------------------------------+-----------------------------+------------------------------+-----+----------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1592321020731_-148250364","id":"20200616-182340_411493177","dateCreated":"2020-06-16T18:23:40+0300","dateStarted":"2020-06-16T20:56:34+0300","dateFinished":"2020-06-16T20:56:37+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11122"},{"text":"%pyspark\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator\nevaluator = MulticlassClassificationEvaluator(predictionCol=\"prediction\")\nprint(f'Accuracy: {evaluator.evaluate(predictions)}')","user":"anonymous","dateUpdated":"2020-06-17T20:53:01+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Accuracy: 0.5756026871922219\n"}]},"apps":[],"jobName":"paragraph_1592323357947_-336166626","id":"20200616-190237_1035307790","dateCreated":"2020-06-16T19:02:37+0300","dateStarted":"2020-06-16T20:57:09+0300","dateFinished":"2020-06-16T20:57:11+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11123"},{"title":"KA5 (ML): Kısım 3 (Dünya kupası verini kumeleme) Herhangi bir kümeleme yontemi ile kumelenmeli ve modelin performansı sunulmalıdır","text":"%md\nhttps://www.kaggle.com/oliversinn/fifa-18-visualisation-clustering-ml/data\n","user":"anonymous","dateUpdated":"2020-06-17T22:04:17+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","title":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p><a href=\"https://www.kaggle.com/oliversinn/fifa-18-visualisation-clustering-ml/data\">https://www.kaggle.com/oliversinn/fifa-18-visualisation-clustering-ml/data</a></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1592420588568_-629458220","id":"20200617-220308_1044157672","dateCreated":"2020-06-17T22:03:08+0300","dateStarted":"2020-06-17T22:04:17+0300","dateFinished":"2020-06-17T22:04:17+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11124"},{"text":"%pyspark\nimport pandas as pd\nimport numpy as np\n","user":"anonymous","dateUpdated":"2020-06-18T21:20:05+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592420657789_366051824","id":"20200617-220417_1501768153","dateCreated":"2020-06-17T22:04:17+0300","dateStarted":"2020-06-18T21:20:06+0300","dateFinished":"2020-06-18T21:20:25+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11125"},{"title":"Load FIFA 18 dataset","text":"%pyspark\n# Read CSV in Pyspark with correct Datatypes\nfifa18_df = (spark.read.format(\"csv\").option(\"mode\", \"DROPMALFORMED\").option(\"header\", \"true\").option(\"inferschema\", \"true\").option(\"delimiter\", \",\").load(\"C:/Users/Administrator/Downloads/complete.csv\"))\n\nfifa18_df.printSchema()\n","user":"anonymous","dateUpdated":"2020-06-18T21:22:14+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- ID: integer (nullable = true)\n |-- name: string (nullable = true)\n |-- full_name: string (nullable = true)\n |-- club: string (nullable = true)\n |-- club_logo: string (nullable = true)\n |-- special: integer (nullable = true)\n |-- age: integer (nullable = true)\n |-- league: string (nullable = true)\n |-- birth_date: timestamp (nullable = true)\n |-- height_cm: double (nullable = true)\n |-- weight_kg: double (nullable = true)\n |-- body_type: string (nullable = true)\n |-- real_face: boolean (nullable = true)\n |-- flag: string (nullable = true)\n |-- nationality: string (nullable = true)\n |-- photo: string (nullable = true)\n |-- eur_value: double (nullable = true)\n |-- eur_wage: double (nullable = true)\n |-- eur_release_clause: double (nullable = true)\n |-- overall: integer (nullable = true)\n |-- potential: integer (nullable = true)\n |-- pac: integer (nullable = true)\n |-- sho: integer (nullable = true)\n |-- pas: integer (nullable = true)\n |-- dri: integer (nullable = true)\n |-- def: integer (nullable = true)\n |-- phy: integer (nullable = true)\n |-- international_reputation: integer (nullable = true)\n |-- skill_moves: integer (nullable = true)\n |-- weak_foot: integer (nullable = true)\n |-- work_rate_att: string (nullable = true)\n |-- work_rate_def: string (nullable = true)\n |-- preferred_foot: string (nullable = true)\n |-- crossing: integer (nullable = true)\n |-- finishing: integer (nullable = true)\n |-- heading_accuracy: integer (nullable = true)\n |-- short_passing: integer (nullable = true)\n |-- volleys: integer (nullable = true)\n |-- dribbling: integer (nullable = true)\n |-- curve: integer (nullable = true)\n |-- free_kick_accuracy: integer (nullable = true)\n |-- long_passing: integer (nullable = true)\n |-- ball_control: integer (nullable = true)\n |-- acceleration: integer (nullable = true)\n |-- sprint_speed: integer (nullable = true)\n |-- agility: integer (nullable = true)\n |-- reactions: integer (nullable = true)\n |-- balance: integer (nullable = true)\n |-- shot_power: integer (nullable = true)\n |-- jumping: integer (nullable = true)\n |-- stamina: integer (nullable = true)\n |-- strength: integer (nullable = true)\n |-- long_shots: integer (nullable = true)\n |-- aggression: integer (nullable = true)\n |-- interceptions: integer (nullable = true)\n |-- positioning: integer (nullable = true)\n |-- vision: integer (nullable = true)\n |-- penalties: integer (nullable = true)\n |-- composure: integer (nullable = true)\n |-- marking: integer (nullable = true)\n |-- standing_tackle: integer (nullable = true)\n |-- sliding_tackle: integer (nullable = true)\n |-- gk_diving: integer (nullable = true)\n |-- gk_handling: integer (nullable = true)\n |-- gk_kicking: integer (nullable = true)\n |-- gk_positioning: integer (nullable = true)\n |-- gk_reflexes: integer (nullable = true)\n |-- rs: double (nullable = true)\n |-- rw: double (nullable = true)\n |-- rf: double (nullable = true)\n |-- ram: double (nullable = true)\n |-- rcm: double (nullable = true)\n |-- rm: double (nullable = true)\n |-- rdm: double (nullable = true)\n |-- rcb: double (nullable = true)\n |-- rb: double (nullable = true)\n |-- rwb: double (nullable = true)\n |-- st: double (nullable = true)\n |-- lw: double (nullable = true)\n |-- cf: double (nullable = true)\n |-- cam: double (nullable = true)\n |-- cm: double (nullable = true)\n |-- lm: double (nullable = true)\n |-- cdm: double (nullable = true)\n |-- cb: double (nullable = true)\n |-- lb: double (nullable = true)\n |-- lwb: double (nullable = true)\n |-- ls: double (nullable = true)\n |-- lf: double (nullable = true)\n |-- lam: double (nullable = true)\n |-- lcm: double (nullable = true)\n |-- ldm: double (nullable = true)\n |-- lcb: double (nullable = true)\n |-- gk: double (nullable = true)\n |-- 1_on_1_rush_trait: boolean (nullable = true)\n |-- acrobatic_clearance_trait: boolean (nullable = true)\n |-- argues_with_officials_trait: boolean (nullable = true)\n |-- avoids_using_weaker_foot_trait: boolean (nullable = true)\n |-- backs_into_player_trait: boolean (nullable = true)\n |-- bicycle_kicks_trait: boolean (nullable = true)\n |-- cautious_with_crosses_trait: boolean (nullable = true)\n |-- chip_shot_trait: boolean (nullable = true)\n |-- chipped_penalty_trait: boolean (nullable = true)\n |-- comes_for_crosses_trait: boolean (nullable = true)\n |-- corner_specialist_trait: boolean (nullable = true)\n |-- diver_trait: boolean (nullable = true)\n |-- dives_into_tackles_trait: boolean (nullable = true)\n |-- diving_header_trait: boolean (nullable = true)\n |-- driven_pass_trait: boolean (nullable = true)\n |-- early_crosser_trait: boolean (nullable = true)\n |-- fan's_favourite_trait: boolean (nullable = true)\n |-- fancy_flicks_trait: boolean (nullable = true)\n |-- finesse_shot_trait: boolean (nullable = true)\n |-- flair_trait: boolean (nullable = true)\n |-- flair_passes_trait: boolean (nullable = true)\n |-- gk_flat_kick_trait: boolean (nullable = true)\n |-- gk_long_throw_trait: boolean (nullable = true)\n |-- gk_up_for_corners_trait: boolean (nullable = true)\n |-- giant_throw_in_trait: boolean (nullable = true)\n |-- inflexible_trait: boolean (nullable = true)\n |-- injury_free_trait: boolean (nullable = true)\n |-- injury_prone_trait: boolean (nullable = true)\n |-- leadership_trait: boolean (nullable = true)\n |-- long_passer_trait: boolean (nullable = true)\n |-- long_shot_taker_trait: boolean (nullable = true)\n |-- long_throw_in_trait: boolean (nullable = true)\n |-- one_club_player_trait: boolean (nullable = true)\n |-- outside_foot_shot_trait: boolean (nullable = true)\n |-- playmaker_trait: boolean (nullable = true)\n |-- power_free_kick_trait: boolean (nullable = true)\n |-- power_header_trait: boolean (nullable = true)\n |-- puncher_trait: boolean (nullable = true)\n |-- rushes_out_of_goal_trait: boolean (nullable = true)\n |-- saves_with_feet_trait: boolean (nullable = true)\n |-- second_wind_trait: boolean (nullable = true)\n |-- selfish_trait: boolean (nullable = true)\n |-- skilled_dribbling_trait: boolean (nullable = true)\n |-- stutter_penalty_trait: boolean (nullable = true)\n |-- swerve_pass_trait: boolean (nullable = true)\n |-- takes_finesse_free_kicks_trait: boolean (nullable = true)\n |-- target_forward_trait: boolean (nullable = true)\n |-- team_player_trait: boolean (nullable = true)\n |-- technical_dribbler_trait: boolean (nullable = true)\n |-- tries_to_beat_defensive_line_trait: boolean (nullable = true)\n |-- poacher_speciality: boolean (nullable = true)\n |-- speedster_speciality: boolean (nullable = true)\n |-- aerial_threat_speciality: boolean (nullable = true)\n |-- dribbler_speciality: boolean (nullable = true)\n |-- playmaker_speciality: boolean (nullable = true)\n |-- engine_speciality: boolean (nullable = true)\n |-- distance_shooter_speciality: boolean (nullable = true)\n |-- crosser_speciality: boolean (nullable = true)\n |-- free_kick_specialist_speciality: boolean (nullable = true)\n |-- tackling_speciality: boolean (nullable = true)\n |-- tactician_speciality: boolean (nullable = true)\n |-- acrobat_speciality: boolean (nullable = true)\n |-- strength_speciality: boolean (nullable = true)\n |-- clinical_finisher_speciality: boolean (nullable = true)\n |-- prefers_rs: boolean (nullable = true)\n |-- prefers_rw: boolean (nullable = true)\n |-- prefers_rf: boolean (nullable = true)\n |-- prefers_ram: boolean (nullable = true)\n |-- prefers_rcm: boolean (nullable = true)\n |-- prefers_rm: boolean (nullable = true)\n |-- prefers_rdm: boolean (nullable = true)\n |-- prefers_rcb: boolean (nullable = true)\n |-- prefers_rb: boolean (nullable = true)\n |-- prefers_rwb: boolean (nullable = true)\n |-- prefers_st: boolean (nullable = true)\n |-- prefers_lw: boolean (nullable = true)\n |-- prefers_cf: boolean (nullable = true)\n |-- prefers_cam: boolean (nullable = true)\n |-- prefers_cm: boolean (nullable = true)\n |-- prefers_lm: boolean (nullable = true)\n |-- prefers_cdm: boolean (nullable = true)\n |-- prefers_cb: boolean (nullable = true)\n |-- prefers_lb: boolean (nullable = true)\n |-- prefers_lwb: boolean (nullable = true)\n |-- prefers_ls: boolean (nullable = true)\n |-- prefers_lf: boolean (nullable = true)\n |-- prefers_lam: boolean (nullable = true)\n |-- prefers_lcm: boolean (nullable = true)\n |-- prefers_ldm: boolean (nullable = true)\n |-- prefers_lcb: boolean (nullable = true)\n |-- prefers_gk: boolean (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1592420730367_-2062155414","id":"20200617-220530_390553097","dateCreated":"2020-06-17T22:05:30+0300","dateStarted":"2020-06-18T21:22:15+0300","dateFinished":"2020-06-18T21:22:20+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11126"},{"text":"%pyspark\n#fifa18_df.schema['age'].dataType","user":"anonymous","dateUpdated":"2020-06-18T20:36:56+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592434843734_-1831828900","id":"20200618-020043_1852094973","dateCreated":"2020-06-18T02:00:43+0300","dateStarted":"2020-06-18T20:36:56+0300","dateFinished":"2020-06-18T20:36:57+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11127"},{"text":"%pyspark\n\n# To see how our dataframe looks we can select a few columns\n\nfifa18_df.select('name', 'club','age', 'league', 'height_cm', 'weight_kg', 'body_type', 'nationality', 'overall').show(5)","user":"anonymous","dateUpdated":"2020-06-18T20:37:00+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+-------------------+---+--------------------+---------+---------+----------+-----------+-------+\n|             name|               club|age|              league|height_cm|weight_kg| body_type|nationality|overall|\n+-----------------+-------------------+---+--------------------+---------+---------+----------+-----------+-------+\n|Cristiano Ronaldo|     Real Madrid CF| 32|Spanish Primera D...|    185.0|     80.0|C. Ronaldo|   Portugal|     94|\n|         L. Messi|       FC Barcelona| 30|Spanish Primera D...|    170.0|     72.0|     Messi|  Argentina|     93|\n|           Neymar|Paris Saint-Germain| 25|      French Ligue 1|    175.0|     68.0|    Neymar|     Brazil|     92|\n|        L. Suárez|       FC Barcelona| 30|Spanish Primera D...|    182.0|     86.0|    Normal|    Uruguay|     92|\n|         M. Neuer|   FC Bayern Munich| 31|   German Bundesliga|    193.0|     92.0|    Normal|    Germany|     92|\n+-----------------+-------------------+---+--------------------+---------+---------+----------+-----------+-------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1592420844427_626505976","id":"20200617-220724_1309444336","dateCreated":"2020-06-17T22:07:24+0300","dateStarted":"2020-06-18T20:37:01+0300","dateFinished":"2020-06-18T20:37:01+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11128"},{"title":"dataframe shape","text":"%pyspark\nprint((fifa18_df.count(), len(fifa18_df.columns)))","user":"anonymous","dateUpdated":"2020-06-18T21:22:28+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(17994, 185)\n"}]},"apps":[],"jobName":"paragraph_1592420970620_1110253691","id":"20200617-220930_913371123","dateCreated":"2020-06-17T22:09:30+0300","dateStarted":"2020-06-18T21:22:28+0300","dateFinished":"2020-06-18T21:22:29+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11129"},{"title":"Now we drop the string columns","text":"%pyspark\nstring_columns = [\n                  'name',\n                  'full_name',\n                  'club',\n                  'club_logo',\n                  'league',\n                  'birth_date',\n                  'body_type',\n                  'flag',\n                  'nationality',\n                  'photo',\n                  'work_rate_att',\n                  'work_rate_def',\n                  'preferred_foot'\n                 ]\n\nfifa18_df = fifa18_df.drop(*string_columns)\n","user":"anonymous","dateUpdated":"2020-06-18T22:23:17+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592430824815_-924192740","id":"20200618-005344_713646869","dateCreated":"2020-06-18T00:53:44+0300","dateStarted":"2020-06-18T22:23:17+0300","dateFinished":"2020-06-18T22:23:17+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11130"},{"text":"%pyspark\nfeature_cols = [\n 'pac',\n 'sho',\n 'pas',\n 'dri',\n 'def',\n 'phy',\n 'international_reputation',\n 'skill_moves',\n 'weak_foot',\n 'crossing',\n 'finishing',\n 'heading_accuracy',\n 'short_passing',\n 'volleys',\n 'dribbling',\n 'curve',\n 'free_kick_accuracy',\n 'long_passing',\n 'ball_control',\n 'acceleration',\n 'sprint_speed',\n 'agility',\n 'reactions',\n 'balance',\n 'shot_power',\n 'jumping',\n 'stamina',\n 'strength',\n 'long_shots',\n 'aggression',\n 'interceptions',\n 'positioning',\n 'vision',\n 'penalties',\n 'composure',\n 'marking',\n 'standing_tackle',\n 'sliding_tackle',\n 'gk_diving',\n 'gk_handling',\n 'gk_kicking',\n 'gk_positioning',\n 'gk_reflexes',\n '1_on_1_rush_trait',\n 'acrobatic_clearance_trait',\n 'argues_with_officials_trait',\n 'avoids_using_weaker_foot_trait',\n 'backs_into_player_trait',\n 'bicycle_kicks_trait',\n 'cautious_with_crosses_trait',\n 'chip_shot_trait',\n 'chipped_penalty_trait',\n 'comes_for_crosses_trait',\n 'corner_specialist_trait',\n 'diver_trait',\n 'dives_into_tackles_trait',\n 'diving_header_trait',\n 'driven_pass_trait',\n 'early_crosser_trait',\n \"fan's_favourite_trait\",\n 'fancy_flicks_trait',\n 'finesse_shot_trait',\n 'flair_trait',\n 'flair_passes_trait',\n 'gk_flat_kick_trait',\n 'gk_long_throw_trait',\n 'gk_up_for_corners_trait',\n 'giant_throw_in_trait',\n 'inflexible_trait',\n 'injury_free_trait',\n 'injury_prone_trait',\n 'leadership_trait',\n 'long_passer_trait',\n 'long_shot_taker_trait',\n 'long_throw_in_trait',\n 'one_club_player_trait',\n 'outside_foot_shot_trait',\n 'playmaker_trait',\n 'power_free_kick_trait',\n 'power_header_trait',\n 'puncher_trait',\n 'rushes_out_of_goal_trait',\n 'saves_with_feet_trait',\n 'second_wind_trait',\n 'selfish_trait',\n 'skilled_dribbling_trait',\n 'stutter_penalty_trait',\n 'swerve_pass_trait',\n 'takes_finesse_free_kicks_trait',\n 'target_forward_trait',\n 'team_player_trait',\n 'technical_dribbler_trait',\n 'tries_to_beat_defensive_line_trait',\n 'poacher_speciality',\n 'speedster_speciality',\n 'aerial_threat_speciality',\n 'dribbler_speciality',\n 'playmaker_speciality',\n 'engine_speciality',\n 'distance_shooter_speciality',\n 'crosser_speciality',\n 'free_kick_specialist_speciality',\n 'tackling_speciality',\n 'tactician_speciality',\n 'acrobat_speciality',\n 'strength_speciality',\n 'clinical_finisher_speciality',\n 'prefers_rs',\n 'prefers_rw',\n 'prefers_rf',\n 'prefers_ram',\n 'prefers_rcm',\n 'prefers_rm',\n 'prefers_rdm',\n 'prefers_rcb',\n 'prefers_rb',\n 'prefers_rwb',\n 'prefers_st',\n 'prefers_lw',\n 'prefers_cf',\n 'prefers_cam',\n 'prefers_cm',\n 'prefers_lm',\n 'prefers_cdm',\n 'prefers_cb',\n 'prefers_lb',\n 'prefers_lwb',\n 'prefers_ls',\n 'prefers_lf',\n 'prefers_lam',\n 'prefers_lcm',\n 'prefers_ldm',\n 'prefers_lcb',\n 'prefers_gk']\n","user":"anonymous","dateUpdated":"2020-06-18T22:23:51+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592504847037_-1880270081","id":"20200618-212727_1035020143","dateCreated":"2020-06-18T21:27:27+0300","dateStarted":"2020-06-18T22:23:52+0300","dateFinished":"2020-06-18T22:23:52+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11131"},{"text":"%pyspark\n# 13 string columns removed\nprint((fifa18_df.count(), len(fifa18_df.columns)))","user":"anonymous","dateUpdated":"2020-06-18T22:24:02+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(17994, 172)\n"}]},"apps":[],"jobName":"paragraph_1592499911601_616986666","id":"20200618-200511_722213087","dateCreated":"2020-06-18T20:05:11+0300","dateStarted":"2020-06-18T22:24:02+0300","dateFinished":"2020-06-18T22:24:03+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11132"},{"text":"%pyspark\nfrom pyspark.ml.feature import VectorAssembler\n\nvecAssembler = VectorAssembler(inputCols=feature_cols, outputCol=\"features\")\nclustered_df = vecAssembler.transform(fifa18_df)","user":"anonymous","dateUpdated":"2020-06-18T22:24:09+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592422196698_-1923057748","id":"20200617-222956_1225387148","dateCreated":"2020-06-17T22:29:56+0300","dateStarted":"2020-06-18T22:24:09+0300","dateFinished":"2020-06-18T22:24:10+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11133"},{"title":"K-Means clustering","text":"%pyspark\nfrom pyspark.ml.clustering import KMeans\n\nkmeans = KMeans(k=8, seed=1)  # 8 clusters\nmodel = kmeans.fit(clustered_df.select('features'))","user":"anonymous","dateUpdated":"2020-06-18T22:25:01+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592422313983_-1385791612","id":"20200617-223153_1896140066","dateCreated":"2020-06-17T22:31:53+0300","dateStarted":"2020-06-18T22:25:01+0300","dateFinished":"2020-06-18T22:25:03+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11134"},{"text":"%pyspark\ntransformed = model.transform(clustered_df)\ntransformed.select('ID','prediction').show(15)","user":"anonymous","dateUpdated":"2020-06-18T22:19:11+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+----------+\n|    ID|prediction|\n+------+----------+\n| 20801|         3|\n|158023|         3|\n|190871|         3|\n|176580|         3|\n|167495|         4|\n|188545|         3|\n|193080|         4|\n|183277|         3|\n|182521|         0|\n|167664|         3|\n|155862|         0|\n|192985|         3|\n|192119|         4|\n|184941|         3|\n|177003|         0|\n+------+----------+\nonly showing top 15 rows\n\n"}]},"apps":[],"jobName":"paragraph_1592423334770_1242979950","id":"20200617-224854_396559066","dateCreated":"2020-06-17T22:48:54+0300","dateStarted":"2020-06-18T22:19:11+0300","dateFinished":"2020-06-18T22:19:11+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11135"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-06-18T21:44:42+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1592505882889_-1891626968","id":"20200618-214442_2019272555","dateCreated":"2020-06-18T21:44:42+0300","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:11136"}],"name":"120201098","id":"2FAGW7FW6","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}